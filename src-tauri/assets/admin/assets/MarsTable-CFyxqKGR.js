import{r as S,j as f,B as ie,R as Ce}from"./index-CrRWnIjq.js";import{i as Fe}from"./index-B1Ox7m8n.js";import{a6 as be,a7 as le,a8 as Be,a9 as ue,aa as oe,ab as fe,ac as pe,ad as H,ae as Ge,af as U,ag as W,ah as V,ai as Ke,aj as k,ak as q,al as ze,am as Te,an as He,ao as Re,ap as Oe,aq as Ne,ar as Ue,as as Ye,at as qe,au as Je,av as Qe,u as je,h as Xe,i as de,f as ce,_ as ge,T as ye,aw as Q,I as j,$ as X,ax as Ze,x as We,m as he,M as Ve,ay as ke}from"./Page-kYXsiZfv.js";import xe from"./AuthButton-BAPOJ_KH.js";import K from"./index.module-DMqkOYU6.js";import{T as ve,i as er}from"./index-BFS5rlf2.js";import"./index-BCFTpXN0.js";import"./MinusOutlined-BsLWaGMW.js";import"./RedoOutlined-B-c2Dsb9.js";import"./index-BTSRI9HO.js";var rr="__lodash_hash_undefined__";function nr(e){return this.__data__.set(e,rr),this}function tr(e){return this.__data__.has(e)}function Y(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new be;++r<t;)this.add(e[r])}Y.prototype.add=Y.prototype.push=nr;Y.prototype.has=tr;function ar(e,r){for(var t=-1,a=e==null?0:e.length;++t<a;)if(r(e[t],t,e))return!0;return!1}function sr(e,r){return e.has(r)}var ir=1,lr=2;function Ee(e,r,t,a,l,s){var u=t&ir,p=e.length,d=r.length;if(p!=d&&!(u&&d>p))return!1;var g=s.get(e),x=s.get(r);if(g&&x)return g==r&&x==e;var y=-1,h=!0,O=t&lr?new Y:void 0;for(s.set(e,r),s.set(r,e);++y<p;){var v=e[y],_=r[y];if(a)var N=u?a(_,v,y,r,e,s):a(v,_,y,e,r,s);if(N!==void 0){if(N)continue;h=!1;break}if(O){if(!ar(r,function(E,L){if(!sr(O,L)&&(v===E||l(v,E,t,a,s)))return O.push(L)})){h=!1;break}}else if(!(v===_||l(v,_,t,a,s))){h=!1;break}}return s.delete(e),s.delete(r),h}function ur(e){var r=-1,t=Array(e.size);return e.forEach(function(a,l){t[++r]=[l,a]}),t}function or(e){var r=-1,t=Array(e.size);return e.forEach(function(a){t[++r]=a}),t}var fr=1,pr=2,dr="[object Boolean]",cr="[object Date]",gr="[object Error]",yr="[object Map]",hr="[object Number]",xr="[object RegExp]",vr="[object Set]",Ar="[object String]",Sr="[object Symbol]",_r="[object ArrayBuffer]",wr="[object DataView]",Ae=le?le.prototype:void 0,Z=Ae?Ae.valueOf:void 0;function Pr(e,r,t,a,l,s,u){switch(t){case wr:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case _r:return!(e.byteLength!=r.byteLength||!s(new ue(e),new ue(r)));case dr:case cr:case hr:return Be(+e,+r);case gr:return e.name==r.name&&e.message==r.message;case xr:case Ar:return e==r+"";case yr:var p=ur;case vr:var d=a&fr;if(p||(p=or),e.size!=r.size&&!d)return!1;var g=u.get(e);if(g)return g==r;a|=pr,u.set(e,r);var x=Ee(p(e),p(r),a,l,s,u);return u.delete(e),x;case Sr:if(Z)return Z.call(e)==Z.call(r)}return!1}var Tr=1,Rr=Object.prototype,Or=Rr.hasOwnProperty;function Nr(e,r,t,a,l,s){var u=t&Tr,p=oe(e),d=p.length,g=oe(r),x=g.length;if(d!=x&&!u)return!1;for(var y=d;y--;){var h=p[y];if(!(u?h in r:Or.call(r,h)))return!1}var O=s.get(e),v=s.get(r);if(O&&v)return O==r&&v==e;var _=!0;s.set(e,r),s.set(r,e);for(var N=u;++y<d;){h=p[y];var E=e[h],L=r[h];if(a)var B=u?a(L,E,h,r,e,s):a(E,L,h,e,r,s);if(!(B===void 0?E===L||l(E,L,t,a,s):B)){_=!1;break}N||(N=h=="constructor")}if(_&&!N){var $=e.constructor,m=r.constructor;$!=m&&"constructor"in e&&"constructor"in r&&!(typeof $=="function"&&$ instanceof $&&typeof m=="function"&&m instanceof m)&&(_=!1)}return s.delete(e),s.delete(r),_}var Er=1,Se="[object Arguments]",_e="[object Array]",z="[object Object]",Lr=Object.prototype,we=Lr.hasOwnProperty;function mr(e,r,t,a,l,s){var u=U(e),p=U(r),d=u?_e:fe(e),g=p?_e:fe(r);d=d==Se?z:d,g=g==Se?z:g;var x=d==z,y=g==z,h=d==g;if(h&&pe(e)){if(!pe(r))return!1;u=!0,x=!1}if(h&&!x)return s||(s=new H),u||Ge(e)?Ee(e,r,t,a,l,s):Pr(e,r,d,t,a,l,s);if(!(t&Er)){var O=x&&we.call(e,"__wrapped__"),v=y&&we.call(r,"__wrapped__");if(O||v){var _=O?e.value():e,N=v?r.value():r;return s||(s=new H),l(_,N,t,a,s)}}return h?(s||(s=new H),Nr(e,r,t,a,l,s)):!1}function ee(e,r,t,a,l){return e===r?!0:e==null||r==null||!W(e)&&!W(r)?e!==e&&r!==r:mr(e,r,t,a,ee,l)}var Dr=1,Mr=2;function Ir(e,r,t,a){var l=t.length,s=l;if(e==null)return!s;for(e=Object(e);l--;){var u=t[l];if(u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++l<s;){u=t[l];var p=u[0],d=e[p],g=u[1];if(u[2]){if(d===void 0&&!(p in e))return!1}else{var x=new H,y;if(!(y===void 0?ee(g,d,Dr|Mr,a,x):y))return!1}}return!0}function Le(e){return e===e&&!V(e)}function $r(e){for(var r=Ke(e),t=r.length;t--;){var a=r[t],l=e[a];r[t]=[a,l,Le(l)]}return r}function me(e,r){return function(t){return t==null?!1:t[e]===r&&(r!==void 0||e in Object(t))}}function Cr(e){var r=$r(e);return r.length==1&&r[0][2]?me(r[0][0],r[0][1]):function(t){return t===e||Ir(t,e,r)}}function Fr(e,r){return e!=null&&r in Object(e)}function br(e,r,t){r=k(r,e);for(var a=-1,l=r.length,s=!1;++a<l;){var u=q(r[a]);if(!(s=e!=null&&t(e,u)))break;e=e[u]}return s||++a!=l?s:(l=e==null?0:e.length,!!l&&ze(l)&&Te(u,l)&&(U(e)||He(e)))}function Br(e,r){return e!=null&&br(e,r,Fr)}var Gr=1,Kr=2;function zr(e,r){return Re(e)&&Le(r)?me(q(e),r):function(t){var a=Oe(t,e);return a===void 0&&a===r?Br(t,e):ee(r,a,Gr|Kr)}}function Hr(e){return function(r){return r==null?void 0:r[e]}}function Ur(e){return function(r){return Ne(r,e)}}function Yr(e){return Re(e)?Hr(q(e)):Ur(e)}function qr(e){return typeof e=="function"?e:e==null?Ue:typeof e=="object"?U(e)?zr(e[0],e[1]):Cr(e):Yr(e)}var Jr="[object Number]";function Pe(e){return typeof e=="number"||W(e)&&Ye(e)==Jr}function Qr(e,r,t,a){if(!V(e))return e;r=k(r,e);for(var l=-1,s=r.length,u=s-1,p=e;p!=null&&++l<s;){var d=q(r[l]),g=t;if(d==="__proto__"||d==="constructor"||d==="prototype")return e;if(l!=u){var x=p[d];g=void 0,g===void 0&&(g=V(x)?x:Te(r[l+1])?[]:{})}qe(p,d,g),p=p[d]}return e}function jr(e,r,t){for(var a=-1,l=r.length,s={};++a<l;){var u=r[a],p=Ne(e,u);t(p,u)&&Qr(s,k(u,e),p)}return s}function Xr(e,r){if(e==null)return{};var t=Je(Qe(e),function(a){return[a]});return r=qr(r),jr(e,t,function(a,l){return r(a,l[0])})}const Zr=({config:e,elements:r,onCheckedChange:t},a)=>{var ne,te,ae;const[l,s]=S.useState({}),[u,p]=S.useState({[e.props.field.pageNum]:1,[e.props.field.pageSize]:e.props.pagination.pageSize}),[d,g]=S.useState([]),[x,y]=S.useState(!1),[h,O]=S.useState(0),[v,_]=S.useState([]),[N,E]=S.useState([]),[L,B]=S.useState(!0),$=je(o=>o.page.pageData.variableData);S.useEffect(()=>{const o={[e.props.field.pageNum]:1,[e.props.field.pageSize]:e.props.pagination.pageSize};p(o),m(e.props.hidePager?{}:o)},[((ne=e.api)==null?void 0:ne.sourceType)=="variable"?$:""]);const m=S.useCallback(o=>{y(!0),Xe(e.api,o).then(n=>{y(!1),(n==null?void 0:n.code)===0&&(Array.isArray(n.data)&&g(n.data),e.props.field.total&&O(Oe(n.originData,e.props.field.total)||0))}).catch(()=>{y(!1)})},[]);S.useImperativeHandle(a,()=>({startLoading:()=>{y(!0)},stopLoading:()=>{y(!1)},show(){B(!0)},hide(){B(!1)},search:o=>{const n=Xr(o,w=>de(w));p({...u,[e.props.field.pageNum]:1}),s(n),m({...u,[e.props.field.pageNum]:1,...n})},reload:()=>{m({...u,...l})},clearData:()=>{g([])},checkSelectedRow:()=>v.length!==0,setSelectedRowKeys:o=>{_(o)},getSelectedRowKeys:()=>({selectedRowKeys:v||[]}),getSelectedRow:()=>N}));const De=S.useMemo(()=>{let o=null;return e.props.selectionType?o={type:e.props.selectionType,selectedRowKeys:v,onChange(n,w){t==null||t({selectedRowKeys:n}),_(n),E(w)}}:o=null,{rowSelection:o,rowKey:e.props.rowKey||"id",bordered:e.props.bordered,size:e.props.size,columns:e.props.columns.map((n,w)=>{const F=n.dataIndex||"-"+w;return{...n,dataIndex:F,key:F,onCell(D,P){if(n.onCell)try{return new Function("record","index",`return (${n.onCell})(record,index);`)(D,P)}catch(M){console.error(`列[${n.title}]渲染失败`,M)}return{}},render(D,P,M){var I,G;let i=D;try{if(de(i)?n.type==="money"?i=ce(D,"currency"):n.type==="number"?i=ce(D):n.type==="date1"?i=ge(D,"YYYY-MM-DD"):n.type==="date2"&&(i=ge(D)):typeof n.empty>"u"?i="-":n.empty&&(i=n.empty),n.render)try{i=new Function("text","record","index",`return (${n.render})(text,record,index);`)(i,P,M)}catch(c){console.error(`列[${n.title}]渲染失败`,c),i="解析异常"}if(n.type==="text"){const c=f.jsx(ie,{type:"link",onClick:()=>J(n.eventName,P),children:i.toString()});return n.ellipsis&&n.copyable?f.jsx(ve,{title:i,children:f.jsx(ye.Paragraph,{copyable:!0,style:{marginBottom:0},children:n.clickable?c:i.toString()})}):n.ellipsis?f.jsx(ve,{title:i,children:n.clickable?c:i.toString()}):n.copyable?f.jsx(ye.Paragraph,{copyable:!0,children:n.clickable?c:i.toString()}):n.clickable?f.jsx(ie,{type:"link",onClick:()=>J(n.eventName,P),children:i.toString()}):i.toString()}if(n.type==="multiline")return Array.isArray(i)?i.map((c,T)=>f.jsxs("div",{children:[f.jsx("span",{children:c.label}),f.jsx("span",{children:c.value})]},T)):i.toString();if(n.type==="status")return Array.isArray(i)?i.map((c,T)=>f.jsx(Q,{status:c.status,text:c.text},T)):typeof i=="object"?f.jsx(Q,{status:i.status,text:i.text}):f.jsx(Q,{status:"success",text:i.toString()});if(n.type==="image"){const{width:c=30,height:T=30}=(n==null?void 0:n.imageConfig)||{};if(Array.isArray(i)){const R=b=>Pe(Number(b))?Number(b):b;return f.jsx(j.PreviewGroup,{items:i,children:f.jsx(j,{width:R(c),height:R(T),src:i[0]})})}const A=R=>Pe(Number(R))?Number(R):R;return((I=i==null?void 0:i.startsWith)==null?void 0:I.call(i,"http"))&&f.jsx(j,{src:i,width:A(c),height:A(T)})||i}if(n.type==="tag")return Array.isArray(i)?i.map((c,T)=>typeof c=="object"?f.jsx(X,{color:c.color,children:c.label},T):f.jsx(X,{color:"green",children:c},c)):typeof i=="string"||typeof i=="number"?f.jsx(X,{color:"green",children:i}):i==null?void 0:i.toString();if(n.type==="action"){const{moreActionIndex:c}=n,T=(G=n.list)==null?void 0:G.map(A=>{var b;let R="";if(typeof A.text=="string")R=A.text;else if(((b=A.text)==null?void 0:b.type)==="static")R=A.text.value;else try{R=new Function("text","record","index",`return (${A.text.value})(text,record,index);`)("",P,M)}catch(se){console.error(`列[${A.title}]渲染失败`,se),R="解析异常"}if(R!=="")return f.jsx(xe,{type:"link",size:"small",danger:A.danger,onClick:()=>J(A.eventName,P),authCode:A.authCode,authScript:A.authScript,children:R},A.eventName)});if(c&&T.slice(c-1).length){const A=f.jsx("div",{style:{display:"flex",flexDirection:"column"},children:T.slice(c-1)});return f.jsxs("div",{className:K.action,children:[T.slice(0,c-1),f.jsx(Ze,{trigger:"click",content:A,children:f.jsx(er,{})})]})}return f.jsx(We,{children:T})}return i}catch(c){return console.error(`列[${n.title}]渲染失败`,c),e.props.empty||"-"}}}}),dataSource:d,loading:x}},[d,x,v]),Me=S.useMemo(()=>{const{pageNum:o="pageNum",pageSize:n="pageSize"}=e.props.field,{showSizeChanger:w,showQuickJumper:F,showTotal:D,pageSize:P,position:M}=e.props.pagination||{},i=P?[P,P*2,P*3,P*4]:[10,20,30,40];return{total:h,current:u[o]||1,pageSize:u[n]||10,pageSizeOptions:i,showSizeChanger:w,showQuickJumper:F,showTotal:D?I=>`共 ${I} 条数据`:void 0,position:M,onChange:(I,G)=>{p({[o]:I,[n]:G}),m({[o]:I,[n]:G,...l})}}},[h,u]),Ie=o=>{const n=e.events.find(w=>w.eventName===o);he(n==null?void 0:n.actions,l)},J=(o,n)=>{const w=e.events.find(F=>F.eventName===o);he(w==null?void 0:w.actions,n)},re=e.props.leftTitle,C=e.props.bulkActionList||[],$e=Fe;return L&&f.jsxs("div",{style:e.style,children:[re||r!=null&&r.length||C!=null&&C.length?f.jsxs("div",{className:K.toolbar,children:[re&&f.jsx("div",{className:K.title,children:e.props.leftTitle}),f.jsxs("div",{className:K.action,children:[r!=null&&r.length?f.jsx(Ve,{elements:r}):null,C==null?void 0:C.map(o=>f.jsx(xe,{type:o.type,danger:o.danger,icon:o.icon?Ce.createElement($e[o.icon]):null,onClick:()=>Ie(o.eventName),authCode:o.authCode,authScript:o.authScript,children:o.text},o.eventName))]})]}):null,f.jsx(ke,{...De,scroll:{x:(te=e.props.scroll)==null?void 0:te.x,y:(ae=e.props.scroll)==null?void 0:ae.y},pagination:e.props.hidePager?!1:Me})]})},un=S.memo(S.forwardRef(Zr));export{un as default};
//# sourceMappingURL=MarsTable-CFyxqKGR.js.map
