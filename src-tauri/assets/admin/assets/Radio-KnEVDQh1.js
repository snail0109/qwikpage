import{r as s,j as n}from"./index-Ba8_Z7I5.js";import{u as j,h as S,i as v,F as V,H as W}from"./Page-zRx-fbuc.js";import{useFormContext as A}from"./context-CZSQjkXQ.js";import"./index-d9iZx7WN.js";import"./index-DzTVI9Lo.js";import"./index-C2BeiomC.js";const F=({type:y,config:a,onChange:p},x)=>{var m;const[D,d]=s.useState([]),{initValues:E}=A(),[c,u]=s.useState(!0),[h,o]=s.useState(),I=j(e=>e.page.pageData.variableData);s.useEffect(()=>{var r;const e=(r=a.props.formItem)==null?void 0:r.name,t=a.props.defaultValue;E(y,e,t)},[a.props.defaultValue]),s.useEffect(()=>{typeof a.props.formWrap.disabled=="boolean"&&o(a.props.formWrap.disabled)},[a.props.formWrap.disabled]),s.useEffect(()=>{i({})},[a.api,((m=a.api)==null?void 0:m.sourceType)=="variable"?I:""]);const i=e=>{S(a.api,e).then(t=>{if((t==null?void 0:t.code)===0)if(!Array.isArray(t.data))console.error("[radio]","data数据格式错误，请检查"),d([]);else{let r=[];a.props.field.label==="label"&&a.props.field.value==="value"?(r=t.data,(typeof t.data[0]=="string"||typeof t.data[0]=="number")&&(r=t.data.map(l=>({label:l,value:l})))):r=t.data.map(l=>{const b=l[a.props.field.label||"label"],f=l[a.props.field.value||"value"];return{label:v(b)?b:"-",value:v(f)?f:""}}),d(r)}})};s.useImperativeHandle(x,()=>({show(){u(!0)},hide(){u(!1)},enable(){o(!1)},disable(){o(!0)},update:e=>{i(e)}}));const R=e=>{p==null||p({[a.props.formItem.name]:e})};return c&&n.jsx(V.Item,{...a.props.formItem,children:n.jsx(W.Group,{...a.props.formWrap,disabled:h,options:D,style:a.style,onChange:e=>R(e.target.value)})})},P=s.forwardRef(F);export{P as default};
