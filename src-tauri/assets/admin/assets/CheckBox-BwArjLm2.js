import{r as s,j as n}from"./index-Ba8_Z7I5.js";import{u as j,h as k,i as v,F as V,t as W}from"./Page-zRx-fbuc.js";import{useFormContext as A}from"./context-CZSQjkXQ.js";import"./index-d9iZx7WN.js";import"./index-DzTVI9Lo.js";import"./index-C2BeiomC.js";const F=({type:x,config:e,onChange:p},c)=>{var m;const[y,u]=s.useState([]),[h,d]=s.useState(!0),[D,o]=s.useState(),{initValues:E}=A(),I=j(a=>a.page.pageData.variableData);s.useEffect(()=>{var r;const a=(r=e.props.formItem)==null?void 0:r.name,t=e.props.defaultValue||[];E(x,a,t)},[JSON.stringify(e.props.defaultValue)]),s.useEffect(()=>{typeof e.props.formWrap.disabled=="boolean"&&o(e.props.formWrap.disabled)},[e.props.formWrap.disabled]),s.useEffect(()=>{i({})},[e.api,((m=e.api)==null?void 0:m.sourceType)=="variable"?I:""]);const i=a=>{k(e.api,a).then(t=>{if((t==null?void 0:t.code)===0)if(!Array.isArray(t.data))console.error("[checkbox]","data数据格式错误，请检查"),u([]);else{let r=[];e.props.field.label==="label"&&e.props.field.value==="value"?(r=t.data,(typeof t.data[0]=="string"||typeof t.data[0]=="number")&&(r=t.data.map(l=>({label:l,value:l})))):r=t.data.map(l=>{const b=l[e.props.field.label||"label"],f=l[e.props.field.value||"value"];return{label:v(b)?b:"-",value:v(f)?f:""}}),u(r)}})};s.useImperativeHandle(c,()=>({show(){d(!0)},hide(){d(!1)},enable(){o(!1)},disable(){o(!0)},update:a=>{i(a)}}));const S=a=>{p==null||p({[e.props.formItem.name]:a})};return h&&n.jsx(V.Item,{...e.props.formItem,children:n.jsx(W.Group,{...e.props.formWrap,disabled:D,options:y,style:e.style,onChange:a=>S(a)})})},H=s.forwardRef(F);export{H as default};
