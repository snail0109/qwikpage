{"version":3,"file":"LineChart-CXhyAawb.js","sources":["../../../packages/materials/EChart/LineChart/LineChart.tsx"],"sourcesContent":["import { ComponentType } from '@materials/types';\nimport { forwardRef, useEffect, useImperativeHandle, useState } from 'react';\nimport { Line } from '@ant-design/plots';\nimport { handleApi } from '@materials/utils/handleApi';\nimport { Spin } from 'antd';\nimport { usePageStore } from '@materials/stores/pageStore';\n\n/**\n *\n * @param config 组件配置属性值\n * @param props 系统属性值：componentid、componentname等\n * @returns 返回组件\n */\nconst LineChart = ({ config }: ComponentType, ref: any) => {\n  const [data, setData] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [visible, setVisible] = useState(true);\n  const variableData = usePageStore((state) => state.page.pageData.variableData);\n  useEffect(() => {\n    getDataList({});\n  }, [config.api, config.api?.sourceType == 'variable' ? variableData : '']);\n\n  const getDataList = (data: any) => {\n    setLoading(true);\n    handleApi(config.api, data).then((res) => {\n      if (res?.code === 0) {\n        if (Array.isArray(res.data)) {\n          setData(res.data);\n        } else {\n          setData([]);\n          console.error('[LineChart]数据格式错误');\n        }\n      }\n      setLoading(false);\n    });\n  };\n  useImperativeHandle(ref, () => {\n    return {\n      show() {\n        setVisible(true);\n      },\n      hide() {\n        setVisible(false);\n      },\n      update: (data: any) => {\n        // 重新加载表格数据\n        getDataList(data);\n      },\n    };\n  });\n  return (\n    visible && (\n      <div style={config.style}>\n        <Spin spinning={loading} size=\"large\" wrapperClassName=\"spin-loading\">\n          <Line {...config.props} color={config.props.seriesField ? config.props.color : config.props.color[0]} data={data} />\n        </Spin>\n      </div>\n    )\n  );\n};\nexport default forwardRef(LineChart);\n"],"names":["LineChart","config","ref","data","setData","useState","loading","setLoading","visible","setVisible","variableData","usePageStore","state","useEffect","getDataList","_a","handleApi","res","useImperativeHandle","jsx","Spin","Line","forwardRef"],"mappings":"+LAaA,MAAMA,EAAY,CAAC,CAAE,OAAAC,GAAyBC,IAAa,OACzD,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAAgB,CAAA,CAAE,EACpC,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAASC,CAAU,EAAIJ,EAAAA,SAAS,EAAI,EACrCK,EAAeC,EAAcC,GAAUA,EAAM,KAAK,SAAS,YAAY,EAC7EC,EAAAA,UAAU,IAAM,CACdC,EAAY,CAAA,CAAE,CAAA,EACb,CAACb,EAAO,MAAKc,EAAAd,EAAO,MAAP,YAAAc,EAAY,aAAc,WAAaL,EAAe,EAAE,CAAC,EAEnE,MAAAI,EAAeX,GAAc,CACjCI,EAAW,EAAI,EACfS,EAAUf,EAAO,IAAKE,CAAI,EAAE,KAAMc,GAAQ,EACpCA,GAAA,YAAAA,EAAK,QAAS,IACZ,MAAM,QAAQA,EAAI,IAAI,EACxBb,EAAQa,EAAI,IAAI,GAEhBb,EAAQ,CAAA,CAAE,EACV,QAAQ,MAAM,mBAAmB,IAGrCG,EAAW,EAAK,CAAA,CACjB,CACH,EACAW,OAAAA,EAAA,oBAAoBhB,EAAK,KAChB,CACL,MAAO,CACLO,EAAW,EAAI,CACjB,EACA,MAAO,CACLA,EAAW,EAAK,CAClB,EACA,OAASN,GAAc,CAErBW,EAAYX,CAAI,CAAA,CAEpB,EACD,EAECK,GACEW,EAAAA,IAAC,MAAI,CAAA,MAAOlB,EAAO,MACjB,SAAAkB,EAAAA,IAACC,EAAK,CAAA,SAAUd,EAAS,KAAK,QAAQ,iBAAiB,eACrD,SAACa,EAAA,IAAAE,EAAA,CAAM,GAAGpB,EAAO,MAAO,MAAOA,EAAO,MAAM,YAAcA,EAAO,MAAM,MAAQA,EAAO,MAAM,MAAM,CAAC,EAAG,KAAAE,CAAY,CAAA,CACpH,CAAA,EACF,CAGN,EACemB,EAAAA,EAAAA,WAAWtB,CAAS"}