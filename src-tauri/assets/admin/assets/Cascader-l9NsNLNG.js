import{r as t,j as i}from"./index-C0qVWane.js";import{u as C,h as D,F as E,q as I}from"./Page-D5iqHLgS.js";import{useFormContext as W}from"./context-dW7PTdPs.js";import"./index-DPKgr_Rt.js";import"./index-i6Qw7kf9.js";import"./index-DfNzS1Q2.js";const j=({type:n,config:a,onChange:p},f)=>{var m;const{initValues:b}=W(),[c,o]=t.useState([]),[h,d]=t.useState(!0),[v,r]=t.useState(),x=C(e=>e.page.pageData.variableData);t.useEffect(()=>{var u;const e=(u=a.props.formItem)==null?void 0:u.name,s=a.props.defaultValue;b(n,e,s)},[a.props.defaultValue]),t.useEffect(()=>{typeof a.props.formWrap.disabled=="boolean"&&r(a.props.formWrap.disabled)},[a.props.formWrap.disabled]),t.useEffect(()=>{l({})},[a.api,((m=a.api)==null?void 0:m.sourceType)=="variable"?x:""]);const l=e=>{D(a.api,e).then(s=>{(s==null?void 0:s.code)===0&&(Array.isArray(s.data)?o(s.data):(console.error("[Cascader]","data数据格式错误，请检查"),o([])))})};t.useImperativeHandle(f,()=>({show(){d(!0)},hide(){d(!1)},enable(){r(!1)},disable(){r(!0)},update:e=>{l(e)}}));const y=e=>{p&&p({[a.props.formItem.name]:e})};return h&&i.jsx(E.Item,{...a.props.formItem,children:i.jsx(I,{...a.props.formWrap,disabled:v,variant:a.props.formWrap.variant||void 0,options:c,style:{...a.style},onChange:e=>y(e)})})},q=t.forwardRef(j);export{q as default};
