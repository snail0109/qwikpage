{"version":3,"file":"Progress-ButURvXh.js","sources":["../../../packages/materials/EChart/Progress/Progress.tsx"],"sourcesContent":["import { ComponentType } from '@materials/types';\nimport { forwardRef, useEffect, useImperativeHandle, useState } from 'react';\nimport { Progress } from '@ant-design/plots';\nimport { handleApi } from '@materials/utils/handleApi';\nimport { Spin } from 'antd';\nimport { usePageStore } from '@materials/stores/pageStore';\n\n/**\n *\n * @param config 组件配置属性值\n * @param props 系统属性值：componentid、componentname等\n * @returns 返回组件\n */\nconst MProgress = ({ config }: ComponentType, ref: any) => {\n  const [data, setData] = useState<string | number>(0);\n  const [loading, setLoading] = useState(true);\n  const [visible, setVisible] = useState(true);\n  const variableData = usePageStore((state) => state.page.pageData.variableData);\n  useEffect(() => {\n    getDataList({});\n  }, [config.api, config.api?.sourceType == 'variable' ? variableData : '']);\n\n  const getDataList = (data: any) => {\n    setLoading(true);\n    handleApi(config.api, data).then((res) => {\n      if (res?.code === 0) {\n        if (typeof res.data === 'number') {\n          setData(res.data);\n        } else {\n          console.error('[Progress]数据格式错误，进度条需要0-1的数字。');\n        }\n      }\n      setLoading(false);\n    });\n  };\n  useImperativeHandle(ref, () => {\n    return {\n      show() {\n        setVisible(true);\n      },\n      hide() {\n        setVisible(false);\n      },\n      update: (data: any) => {\n        // 重新加载表格数据\n        getDataList(data);\n      },\n    };\n  });\n  return (\n    visible && (\n      <div style={config.style}>\n        <Spin spinning={loading} size=\"large\" wrapperClassName=\"spin-loading\">\n          <Progress {...config.props} percent={data} />\n        </Spin>\n      </div>\n    )\n  );\n};\nexport default forwardRef(MProgress);\n"],"names":["MProgress","config","ref","data","setData","useState","loading","setLoading","visible","setVisible","variableData","usePageStore","state","useEffect","getDataList","_a","handleApi","res","useImperativeHandle","jsx","Spin","Progress","forwardRef"],"mappings":"+LAaA,MAAMA,EAAY,CAAC,CAAE,OAAAC,GAAyBC,IAAa,OACzD,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAA0B,CAAC,EAC7C,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAASC,CAAU,EAAIJ,EAAAA,SAAS,EAAI,EACrCK,EAAeC,EAAcC,GAAUA,EAAM,KAAK,SAAS,YAAY,EAC7EC,EAAAA,UAAU,IAAM,CACdC,EAAY,CAAA,CAAE,CAAA,EACb,CAACb,EAAO,MAAKc,EAAAd,EAAO,MAAP,YAAAc,EAAY,aAAc,WAAaL,EAAe,EAAE,CAAC,EAEnE,MAAAI,EAAeX,GAAc,CACjCI,EAAW,EAAI,EACfS,EAAUf,EAAO,IAAKE,CAAI,EAAE,KAAMc,GAAQ,EACpCA,GAAA,YAAAA,EAAK,QAAS,IACZ,OAAOA,EAAI,MAAS,SACtBb,EAAQa,EAAI,IAAI,EAEhB,QAAQ,MAAM,+BAA+B,GAGjDV,EAAW,EAAK,CAAA,CACjB,CACH,EACAW,OAAAA,EAAA,oBAAoBhB,EAAK,KAChB,CACL,MAAO,CACLO,EAAW,EAAI,CACjB,EACA,MAAO,CACLA,EAAW,EAAK,CAClB,EACA,OAASN,GAAc,CAErBW,EAAYX,CAAI,CAAA,CAEpB,EACD,EAECK,SACG,MAAI,CAAA,MAAOP,EAAO,MACjB,SAAAkB,EAAAA,IAACC,EAAK,CAAA,SAAUd,EAAS,KAAK,QAAQ,iBAAiB,eACrD,eAACe,EAAU,CAAA,GAAGpB,EAAO,MAAO,QAASE,CAAM,CAAA,CAAA,CAC7C,CACF,CAAA,CAGN,EACemB,EAAAA,EAAAA,WAAWtB,CAAS"}