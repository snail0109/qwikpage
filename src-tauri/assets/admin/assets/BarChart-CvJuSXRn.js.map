{"version":3,"file":"BarChart-CvJuSXRn.js","sources":["../../../packages/materials/EChart/BarChart/BarChart.tsx"],"sourcesContent":["import { ComponentType } from '@materials/types';\nimport { forwardRef, useEffect, useImperativeHandle, useState } from 'react';\nimport { Bar } from '@ant-design/plots';\nimport { handleApi } from '@materials/utils/handleApi';\nimport { Spin } from 'antd';\nimport { usePageStore } from '@materials/stores/pageStore';\n/**\n *\n * @param props 组件本身属性\n * @param style 组件样式\n * @param attr 组件其它属性，比如：id、type、className\n * @returns\n */\nconst EChart = ({ config }: ComponentType, ref: any) => {\n  const [data, setData] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [visible, setVisible] = useState(true);\n  const variableData = usePageStore((state) => state.page.pageData.variableData);\n  useEffect(() => {\n    getDataList({});\n  }, [config.api, config.api?.sourceType == 'variable' ? variableData : '']);\n  const getDataList = (data: any) => {\n    setLoading(true);\n    handleApi(config.api, data).then((res) => {\n      if (res?.code === 0) {\n        if (Array.isArray(res.data)) {\n          setData(res.data);\n        } else {\n          console.error('[BarChart]', 'data数据格式错误，请检查');\n          setData([]);\n        }\n      }\n      setLoading(false);\n    });\n  };\n  useImperativeHandle(ref, () => {\n    return {\n      show() {\n        setVisible(true);\n      },\n      hide() {\n        setVisible(false);\n      },\n      update: (data: any) => {\n        // 重新加载表格数据\n        getDataList(data);\n      },\n    };\n  });\n  return (\n    visible && (\n      <div style={config.style}>\n        <Spin spinning={loading} size=\"large\" wrapperClassName=\"spin-loading\">\n          <Bar {...config.props} color={config.props.seriesField ? config.props.color : config.props.color[0]} data={data} />\n        </Spin>\n      </div>\n    )\n  );\n};\nexport default forwardRef(EChart);\n"],"names":["EChart","config","ref","data","setData","useState","loading","setLoading","visible","setVisible","variableData","usePageStore","state","useEffect","getDataList","_a","handleApi","res","useImperativeHandle","jsx","Spin","Bar","forwardRef"],"mappings":"+LAaA,MAAMA,EAAS,CAAC,CAAE,OAAAC,GAAyBC,IAAa,OACtD,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAAgB,CAAA,CAAE,EACpC,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAASC,CAAU,EAAIJ,EAAAA,SAAS,EAAI,EACrCK,EAAeC,EAAcC,GAAUA,EAAM,KAAK,SAAS,YAAY,EAC7EC,EAAAA,UAAU,IAAM,CACdC,EAAY,CAAA,CAAE,CAAA,EACb,CAACb,EAAO,MAAKc,EAAAd,EAAO,MAAP,YAAAc,EAAY,aAAc,WAAaL,EAAe,EAAE,CAAC,EACnE,MAAAI,EAAeX,GAAc,CACjCI,EAAW,EAAI,EACfS,EAAUf,EAAO,IAAKE,CAAI,EAAE,KAAMc,GAAQ,EACpCA,GAAA,YAAAA,EAAK,QAAS,IACZ,MAAM,QAAQA,EAAI,IAAI,EACxBb,EAAQa,EAAI,IAAI,GAER,QAAA,MAAM,aAAc,gBAAgB,EAC5Cb,EAAQ,CAAA,CAAE,IAGdG,EAAW,EAAK,CAAA,CACjB,CACH,EACAW,OAAAA,EAAA,oBAAoBhB,EAAK,KAChB,CACL,MAAO,CACLO,EAAW,EAAI,CACjB,EACA,MAAO,CACLA,EAAW,EAAK,CAClB,EACA,OAASN,GAAc,CAErBW,EAAYX,CAAI,CAAA,CAEpB,EACD,EAECK,GACEW,EAAAA,IAAC,MAAI,CAAA,MAAOlB,EAAO,MACjB,SAAAkB,EAAAA,IAACC,EAAK,CAAA,SAAUd,EAAS,KAAK,QAAQ,iBAAiB,eACrD,SAACa,EAAA,IAAAE,EAAA,CAAK,GAAGpB,EAAO,MAAO,MAAOA,EAAO,MAAM,YAAcA,EAAO,MAAM,MAAQA,EAAO,MAAM,MAAM,CAAC,EAAG,KAAAE,CAAY,CAAA,CACnH,CAAA,EACF,CAGN,EACemB,EAAAA,EAAAA,WAAWtB,CAAM"}