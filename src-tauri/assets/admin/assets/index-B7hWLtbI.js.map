{"version":3,"file":"index-B7hWLtbI.js","sources":["../../../packages/admin/src/pages/page/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { ConfigProvider } from 'antd';\nimport { useShallow } from 'zustand/react/shallow';\nimport Page from '@marsview/materials/Page/Page';\nimport { usePageStore } from '@marsview/materials/stores/pageStore';\nimport { message } from '@/utils/AntdGlobal';\nimport { getPageDetail } from '@/api/index';\nimport locale from 'antd/locale/zh_CN';\nimport 'dayjs/locale/zh-cn';\nimport { ComItemType, ConfigType } from '@marsview/materials/types/index';\n\nexport default function () {\n  const [theme, setTheme] = useState('');\n  const [pageData, setPageData] = useState<{ config: ConfigType; elements: ComItemType[] }>();\n  const { id } = useParams();\n  const { savePageInfo, clearPageInfo } = usePageStore(\n    useShallow((state) => {\n      return {\n        savePageInfo: state.savePageInfo,\n        clearPageInfo: state.clearPageInfo,\n      };\n    }),\n  );\n  const navigate = useNavigate();\n  useEffect(() => {\n    if (id) {\n      getPageDetail(id)\n        .then((res: any) => {\n          if (!res.id) {\n            return navigate('/404');\n          }\n          let pageData: any = {};\n          try {\n            pageData = JSON.parse(res.pageData || '{}');\n          } catch (error) {\n            console.error(error);\n            console.info('【json数据】', res.pageData);\n            message.error('页面数据格式错误，请检查');\n          }\n          clearPageInfo();\n          savePageInfo({\n            ...res,\n            pageData,\n          });\n          setPageData(pageData);\n          setTheme(pageData.config.props.theme || '#1677ff');\n        })\n        .catch(() => {\n          navigate('/500');\n        });\n    }\n  }, [id]);\n  return (\n    <ConfigProvider\n      locale={locale}\n      theme={{\n        cssVar: true,\n        hashed: false,\n        token: {\n          colorPrimary: theme,\n          colorLink: theme,\n          colorInfo: theme,\n        },\n      }}\n    >\n      <Page config={pageData?.config} elements={pageData?.elements} />\n    </ConfigProvider>\n  );\n}\n"],"names":["index","theme","setTheme","useState","pageData","setPageData","id","useParams","savePageInfo","clearPageInfo","usePageStore","useShallow","state","navigate","useNavigate","useEffect","getPageDetail","res","error","message","jsx","ConfigProvider","locale","Page"],"mappings":"mQAY2B,SAAAA,GAAA,CACzB,KAAM,CAACC,EAAOC,CAAQ,EAAIC,EAAAA,SAAS,EAAE,EAC/B,CAACC,EAAUC,CAAW,EAAIF,WAA0D,EACpF,CAAE,GAAAG,CAAG,EAAIC,EAAU,EACnB,CAAE,aAAAC,EAAc,cAAAC,CAAA,EAAkBC,EACtCC,EAAYC,IACH,CACL,aAAcA,EAAM,aACpB,cAAeA,EAAM,aACvB,EACD,CACH,EACMC,EAAWC,EAAY,EAC7BC,OAAAA,EAAAA,UAAU,IAAM,CACVT,GACFU,EAAcV,CAAE,EACb,KAAMW,GAAa,CACd,GAAA,CAACA,EAAI,GACP,OAAOJ,EAAS,MAAM,EAExB,IAAIT,EAAgB,CAAC,EACjB,GAAA,CACFA,EAAW,KAAK,MAAMa,EAAI,UAAY,IAAI,QACnCC,EAAO,CACd,QAAQ,MAAMA,CAAK,EACX,QAAA,KAAK,WAAYD,EAAI,QAAQ,EACrCE,EAAQ,MAAM,cAAc,CAAA,CAEhBV,EAAA,EACDD,EAAA,CACX,GAAGS,EACH,SAAAb,CAAA,CACD,EACDC,EAAYD,CAAQ,EACpBF,EAASE,EAAS,OAAO,MAAM,OAAS,SAAS,CAAA,CAClD,EACA,MAAM,IAAM,CACXS,EAAS,MAAM,CAAA,CAChB,CACL,EACC,CAACP,CAAE,CAAC,EAELc,EAAA,IAACC,EAAA,CACC,OAAAC,EACA,MAAO,CACL,OAAQ,GACR,OAAQ,GACR,MAAO,CACL,aAAcrB,EACd,UAAWA,EACX,UAAWA,CAAA,CAEf,EAEA,eAACsB,EAAK,CAAA,OAAQnB,GAAA,YAAAA,EAAU,OAAQ,SAAUA,GAAA,YAAAA,EAAU,QAAU,CAAA,CAAA,CAChE,CAEJ"}