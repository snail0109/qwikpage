import{r as t,j as b}from"./index-Ba8_Z7I5.js";import{u as E,h as I,F as j,K as V}from"./Page-zRx-fbuc.js";import{useFormContext as W}from"./context-CZSQjkXQ.js";import"./index-d9iZx7WN.js";import"./index-DzTVI9Lo.js";import"./index-C2BeiomC.js";const A=({type:f,config:e,onChange:o},c)=>{var d,u,i;const[h,p]=t.useState([]),[x,l]=t.useState(!0),[S,r]=t.useState(),{initValues:v}=W(),y=E(a=>a.page.pageData.variableData);t.useEffect(()=>{var n;const a=(n=e.props.formItem)==null?void 0:n.name,s=e.props.defaultValue;v(f,a,s)},[e.props.defaultValue]),t.useEffect(()=>{typeof e.props.formWrap.disabled=="boolean"&&r(e.props.formWrap.disabled)},[(d=e.props.formWrap)==null?void 0:d.disabled]),t.useEffect(()=>{m({})},[e.api,((u=e.api)==null?void 0:u.sourceType)=="variable"?y:""]);const m=a=>{I(e.api,a).then(s=>{(s==null?void 0:s.code)===0&&(Array.isArray(s.data)?p(s.data):(console.error("[segmentd]","data数据格式错误，请检查"),p([])))})};t.useImperativeHandle(c,()=>({show(){l(!0)},hide(){l(!1)},enable(){r(!1)},disable(){r(!0)},update:a=>{m(a)}}));const D=a=>{o&&o({[e.props.formItem.name]:a})};return x&&b.jsx(j.Item,{...e.props.formItem,children:b.jsx(V,{disabled:S,block:(i=e.props.formWrap)==null?void 0:i.block,options:h,style:e.style,onChange:D})})},K=t.forwardRef(A);export{K as default};
