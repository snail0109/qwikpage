{"version":3,"file":"TimePickerRange-JKvCpKuw.js","sources":["../../../packages/materials/FormItems/TimePickerRange/TimePickerRange.tsx"],"sourcesContent":["import { ComponentType } from '@materials/types';\nimport { isNotEmpty } from '@materials/utils/util';\nimport { Form, FormItemProps, FormInstance, TimePicker } from 'antd';\nimport { useEffect, useState, useImperativeHandle, forwardRef } from 'react';\nimport { useFormContext } from '@materials/utils/context';\n\nimport dayjs from 'dayjs';\n\nexport interface IConfig {\n  defaultValue: string;\n  startField: string;\n  endField: string;\n  formItem: FormItemProps;\n  formWrap: any;\n}\n/**\n *\n * @param config 组件配置属性值\n * @param props 系统属性值：componentid、componentname等\n * @returns 返回组件\n */\nconst MTimePickerRange = ({ type, config, onChange }: ComponentType<IConfig> & { form: FormInstance }, ref: any) => {\n  const { initValues } = useFormContext();\n  const [visible, setVisible] = useState(true);\n  const [disabled, setDisabled] = useState(config.props.formWrap.disabled);\n  // 初始化默认值\n  useEffect(() => {\n    const name: string = config.props.formItem?.name;\n    const value = config.props.defaultValue;\n    // 日期组件初始化值\n    if (name && isNotEmpty(value)) {\n      const fmt = config.props.formWrap.format || 'HH:mm:ss';\n      const rangeTime = value.split(',').map((item) => dayjs(item, fmt));\n      initValues(type, name, rangeTime);\n    }\n  }, []);\n\n  // 启用和禁用\n  useEffect(() => {\n    setDisabled(config.props.formWrap.disabled);\n  }, [config.props.formWrap.disabled]);\n\n  // 对外暴露方法\n  useImperativeHandle(ref, () => {\n    return {\n      show() {\n        setVisible(true);\n      },\n      hide() {\n        setVisible(false);\n      },\n      enable() {\n        setDisabled(false);\n      },\n      disable() {\n        setDisabled(true);\n      },\n    };\n  });\n\n  const handleChange = (times: any) => {\n    const obj: any = {};\n    const {\n      startField,\n      endField,\n      formItem: { name },\n      formWrap: { format },\n    } = config.props;\n    const [start, end] = times.map((date: any) => date?.format(format));\n    if (startField && endField) {\n      obj[startField] = start;\n      obj[endField] = end;\n      delete obj[name];\n    } else {\n      obj[name] = [start, end];\n    }\n    onChange?.(obj);\n  };\n  return (\n    visible && (\n      <Form.Item {...config.props.formItem}>\n        <TimePicker.RangePicker\n          {...config.props.formWrap}\n          disabled={disabled}\n          variant={config.props.formWrap.variant || undefined}\n          style={config.style}\n          onChange={handleChange}\n        />\n      </Form.Item>\n    )\n  );\n};\nexport default forwardRef(MTimePickerRange);\n"],"names":["MTimePickerRange","type","config","onChange","ref","initValues","useFormContext","visible","setVisible","useState","disabled","setDisabled","useEffect","name","_a","value","isNotEmpty","fmt","rangeTime","item","dayjs","useImperativeHandle","handleChange","times","obj","startField","endField","format","start","end","date","Form","jsx","TimePicker","forwardRef"],"mappings":"sPAqBA,MAAMA,EAAmB,CAAC,CAAE,KAAAC,EAAM,OAAAC,EAAQ,SAAAC,CAAA,EAA6DC,IAAa,CAC5G,KAAA,CAAE,WAAAC,CAAW,EAAIC,EAAe,EAChC,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAI,EACrC,CAACC,EAAUC,CAAW,EAAIF,EAAAA,SAASP,EAAO,MAAM,SAAS,QAAQ,EAEvEU,EAAAA,UAAU,IAAM,OACR,MAAAC,GAAeC,EAAAZ,EAAO,MAAM,WAAb,YAAAY,EAAuB,KACtCC,EAAQb,EAAO,MAAM,aAEvB,GAAAW,GAAQG,EAAWD,CAAK,EAAG,CAC7B,MAAME,EAAMf,EAAO,MAAM,SAAS,QAAU,WACtCgB,EAAYH,EAAM,MAAM,GAAG,EAAE,IAAKI,GAASC,EAAMD,EAAMF,CAAG,CAAC,EACtDZ,EAAAJ,EAAMY,EAAMK,CAAS,CAAA,CAEpC,EAAG,EAAE,EAGLN,EAAAA,UAAU,IAAM,CACFD,EAAAT,EAAO,MAAM,SAAS,QAAQ,GACzC,CAACA,EAAO,MAAM,SAAS,QAAQ,CAAC,EAGnCmB,EAAA,oBAAoBjB,EAAK,KAChB,CACL,MAAO,CACLI,EAAW,EAAI,CACjB,EACA,MAAO,CACLA,EAAW,EAAK,CAClB,EACA,QAAS,CACPG,EAAY,EAAK,CACnB,EACA,SAAU,CACRA,EAAY,EAAI,CAAA,CAEpB,EACD,EAEK,MAAAW,EAAgBC,GAAe,CACnC,MAAMC,EAAW,CAAC,EACZ,CACJ,WAAAC,EACA,SAAAC,EACA,SAAU,CAAE,KAAAb,CAAK,EACjB,SAAU,CAAE,OAAAc,CAAO,GACjBzB,EAAO,MACL,CAAC0B,EAAOC,CAAG,EAAIN,EAAM,IAAKO,GAAcA,GAAA,YAAAA,EAAM,OAAOH,EAAO,EAC9DF,GAAcC,GAChBF,EAAIC,CAAU,EAAIG,EAClBJ,EAAIE,CAAQ,EAAIG,EAChB,OAAOL,EAAIX,CAAI,GAEfW,EAAIX,CAAI,EAAI,CAACe,EAAOC,CAAG,EAEzB1B,GAAA,MAAAA,EAAWqB,EACb,EAEE,OAAAjB,SACGwB,EAAK,KAAL,CAAW,GAAG7B,EAAO,MAAM,SAC1B,SAAA8B,EAAA,IAACC,EAAW,YAAX,CACE,GAAG/B,EAAO,MAAM,SACjB,SAAAQ,EACA,QAASR,EAAO,MAAM,SAAS,SAAW,OAC1C,MAAOA,EAAO,MACd,SAAUoB,CAAA,CAAA,EAEd,CAGN,EACeY,EAAAA,EAAAA,WAAWlC,CAAgB"}