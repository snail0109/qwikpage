import{r as i,j as c}from"./index-Ba8_Z7I5.js";import{u as P}from"./index-d9iZx7WN.js";import{F as D,u as R,a as f,i as h,g as w,b as S,d as E,M as H}from"./Page-zRx-fbuc.js";import{FormContext as I}from"./context-CZSQjkXQ.js";import"./index-DzTVI9Lo.js";import"./index-C2BeiomC.js";const M=({id:o,config:p,elements:u,onFinish:l,onChange:n},V)=>{const[a]=D.useForm(),{formData:d,setFormData:m}=R(P(e=>({formData:e.page.pageData.formData,setFormData:e.setFormData}))),[b,F]=i.useState(!0),[g,v]=i.useState({}),x=e=>{l==null||l(f(u,e))},y=(e,t)=>{const r=f(u,t);n==null||n(r),m({name:o,value:r})};i.useImperativeHandle(V,()=>({show(){F(!0)},hide(){F(!1)},reset(){a.resetFields(),m({name:o,value:a.getFieldsValue(),type:"override"})},submit(){a.submit()},async validate(){try{return await a.validateFields(),!0}catch(e){return console.error(e),!1}},init(e={}){const t=f(u,e);a.setFieldsValue(t),m({name:o,value:t,type:"override"})},getFormData(e){var t;return e&&typeof e=="string"?(t=d[o])==null?void 0:t[e]:d[o]}}));const j=i.useCallback((e,t,r)=>{if(t&&h(r)){let s=r;e==="InputNumber"&&(s=Number(r)),e==="DatePicker"&&(s=w(r)),e==="DatePickerRange"&&(s=S(r)),e==="TimePicker"&&(s=E(r,"HH:mm:ss")),v({[t]:s}),a.setFieldValue([t],s),m({name:o,value:{[t]:s}})}},[]);return b&&c.jsx(I.Provider,{value:{initValues:j},children:c.jsx(D,{form:a,style:p.style,...p.props,initialValues:g,onFinish:x,onValuesChange:y,children:c.jsx(H,{elements:u})})})},q=i.memo(i.forwardRef(M));export{q as default};
