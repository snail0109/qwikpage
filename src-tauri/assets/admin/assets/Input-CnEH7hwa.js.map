{"version":3,"file":"Input-CnEH7hwa.js","sources":["../../../packages/materials/FormItems/Input/Input.tsx"],"sourcesContent":["import React, { forwardRef, useEffect, useImperativeHandle, useState } from 'react';\nimport { Form, Input, InputProps, FormItemProps } from 'antd';\nimport * as icons from '@ant-design/icons';\nimport { ComponentType } from '@materials/types';\nimport { isNull } from '@materials/utils/util';\nimport { useFormContext } from '@materials/utils/context';\nimport omit from 'lodash-es/omit';\n\n/* 泛型只需要定义组件本身用到的属性，当然也可以不定义，默认为any */\nexport interface IConfig {\n  defaultValue: string;\n  formItem: FormItemProps;\n  formWrap: InputProps & { prefixIcons?: string; suffixIcons?: string };\n}\n/**\n *\n * @param config 组件配置属性值\n * @param props 系统属性值：componentid、componentname等\n * @returns 返回组件\n */\nconst MInput = ({ type, config, onChange, onBlur, onPressEnter }: ComponentType<IConfig>, ref: any) => {\n  const { initValues } = useFormContext();\n  const [visible, setVisible] = useState(true);\n  const [disabled, setDisabled] = useState<boolean | undefined>();\n  // 初始化默认值\n  useEffect(() => {\n    const name: string = config.props.formItem?.name;\n    const value = config.props.defaultValue;\n    initValues(type, name, value);\n  }, [config.props.defaultValue]);\n\n  // 启用和禁用\n  useEffect(() => {\n    if (typeof config.props.formWrap.disabled === 'boolean') setDisabled(config.props.formWrap.disabled);\n  }, [config.props.formWrap.disabled]);\n\n  // 输入事件\n  const handleChange = (val: string) => {\n    onChange &&\n      onChange({\n        [config.props.formItem.name]: val,\n      });\n  };\n\n  // 失去焦点事件\n  const handleBlur = (val: string) => {\n    onBlur?.({\n      [config.props.formItem.name]: val,\n    });\n  };\n\n  // 回车事件\n  const handlePressEnter = (val: string) => {\n    onPressEnter?.({\n      [config.props.formItem.name]: val,\n    });\n  };\n\n  useImperativeHandle(ref, () => {\n    return {\n      show() {\n        setVisible(true);\n      },\n      hide() {\n        setVisible(false);\n      },\n      enable() {\n        setDisabled(false);\n      },\n      disable() {\n        setDisabled(true);\n      },\n    };\n  });\n  const iconsList: { [key: string]: any } = icons;\n  return (\n    visible && (\n      <Form.Item {...config.props.formItem}>\n        <Input\n          {...omit(config.props.formWrap, ['prefixIcons', 'suffixIcons'])}\n          disabled={disabled}\n          variant={config.props.formWrap.variant || undefined}\n          style={config.style}\n          prefix={config.props.formWrap.prefixIcons ? React.createElement(iconsList[config.props.formWrap.prefixIcons]) : null}\n          suffix={config.props.formWrap.suffixIcons ? React.createElement(iconsList[config.props.formWrap.suffixIcons]) : null}\n          onChange={(event) => handleChange(event.target.value)}\n          onBlur={(event) => handleBlur(event.target.value)}\n          onPressEnter={(event: any) => handlePressEnter(event.target.value)}\n        />\n      </Form.Item>\n    )\n  );\n};\n\nexport default forwardRef(MInput);\n"],"names":["MInput","type","config","onChange","onBlur","onPressEnter","ref","initValues","useFormContext","visible","setVisible","useState","disabled","setDisabled","useEffect","name","_a","value","handleChange","val","handleBlur","handlePressEnter","useImperativeHandle","iconsList","icons","Form","jsx","Input","omit","React","event","forwardRef"],"mappings":"qWAoBA,MAAMA,EAAS,CAAC,CAAE,KAAAC,EAAM,OAAAC,EAAQ,SAAAC,EAAU,OAAAC,EAAQ,aAAAC,CAAa,EAA2BC,IAAa,CAC/F,KAAA,CAAE,WAAAC,CAAW,EAAIC,EAAe,EAChC,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAI,EACrC,CAACC,EAAUC,CAAW,EAAIF,WAA8B,EAE9DG,EAAAA,UAAU,IAAM,OACR,MAAAC,GAAeC,EAAAd,EAAO,MAAM,WAAb,YAAAc,EAAuB,KACtCC,EAAQf,EAAO,MAAM,aAChBK,EAAAN,EAAMc,EAAME,CAAK,CAC3B,EAAA,CAACf,EAAO,MAAM,YAAY,CAAC,EAG9BY,EAAAA,UAAU,IAAM,CACV,OAAOZ,EAAO,MAAM,SAAS,UAAa,WAAuBW,EAAAX,EAAO,MAAM,SAAS,QAAQ,GAClG,CAACA,EAAO,MAAM,SAAS,QAAQ,CAAC,EAG7B,MAAAgB,EAAgBC,GAAgB,CACpChB,GACEA,EAAS,CACP,CAACD,EAAO,MAAM,SAAS,IAAI,EAAGiB,CAAA,CAC/B,CACL,EAGMC,EAAcD,GAAgB,CACzBf,GAAA,MAAAA,EAAA,CACP,CAACF,EAAO,MAAM,SAAS,IAAI,EAAGiB,CAAA,EAElC,EAGME,EAAoBF,GAAgB,CACzBd,GAAA,MAAAA,EAAA,CACb,CAACH,EAAO,MAAM,SAAS,IAAI,EAAGiB,CAAA,EAElC,EAEAG,EAAA,oBAAoBhB,EAAK,KAChB,CACL,MAAO,CACLI,EAAW,EAAI,CACjB,EACA,MAAO,CACLA,EAAW,EAAK,CAClB,EACA,QAAS,CACPG,EAAY,EAAK,CACnB,EACA,SAAU,CACRA,EAAY,EAAI,CAAA,CAEpB,EACD,EACD,MAAMU,EAAoCC,EAExC,OAAAf,SACGgB,EAAK,KAAL,CAAW,GAAGvB,EAAO,MAAM,SAC1B,SAAAwB,EAAA,IAACC,EAAA,CACE,GAAGC,EAAK1B,EAAO,MAAM,SAAU,CAAC,cAAe,aAAa,CAAC,EAC9D,SAAAU,EACA,QAASV,EAAO,MAAM,SAAS,SAAW,OAC1C,MAAOA,EAAO,MACd,OAAQA,EAAO,MAAM,SAAS,YAAc2B,EAAM,cAAcN,EAAUrB,EAAO,MAAM,SAAS,WAAW,CAAC,EAAI,KAChH,OAAQA,EAAO,MAAM,SAAS,YAAc2B,EAAM,cAAcN,EAAUrB,EAAO,MAAM,SAAS,WAAW,CAAC,EAAI,KAChH,SAAW4B,GAAUZ,EAAaY,EAAM,OAAO,KAAK,EACpD,OAASA,GAAUV,EAAWU,EAAM,OAAO,KAAK,EAChD,aAAeA,GAAeT,EAAiBS,EAAM,OAAO,KAAK,CAAA,CAAA,EAErE,CAGN,EAEeC,EAAAA,EAAAA,WAAW/B,CAAM"}