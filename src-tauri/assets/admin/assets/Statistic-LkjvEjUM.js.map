{"version":3,"file":"Statistic-LkjvEjUM.js","sources":["../../../packages/materials/Basic/Statistic/Statistic.tsx"],"sourcesContent":["import React, { useState, useEffect, useImperativeHandle, forwardRef } from 'react';\nimport { Statistic } from 'antd';\nimport { ComponentType } from '@materials/types';\nimport * as icons from '@ant-design/icons';\nimport { message } from '@materials/utils/AntdGlobal';\nimport { omit } from 'lodash-es';\n/**\n *\n * @param props 组件本身属性\n * @param style 组件样式\n * @returns\n */\nconst MStatistic = ({ config }: ComponentType, ref: any) => {\n  const [text, setText] = useState('');\n  const [visible, setVisible] = useState(true);\n\n  useEffect(() => {\n    const originText = config.props?.value?.toString() || '';\n    const script = config.props?.script;\n    let value: string | number = originText;\n\n    if (script) {\n      try {\n        const renderFn = new Function('value', `return (${script})(value);`);\n        value = renderFn(value);\n      } catch (error) {\n        console.error(`脚本解析失败`, error);\n        message.error(JSON.stringify(error));\n      }\n    }\n    setText(value?.toString());\n  }, [config.props.value, config.props?.script]);\n\n  // 对外暴露方法\n  useImperativeHandle(ref, () => {\n    return {\n      show() {\n        setVisible(true);\n      },\n      hide() {\n        setVisible(false);\n      },\n    };\n  });\n\n  const iconsList: { [key: string]: any } = icons;\n  return (\n    visible && (\n      <Statistic\n        style={config.style}\n        {...omit(config.props, ['script', 'prefix', 'suffix'])}\n        value={text}\n        prefix={config.props.prefix ? React.createElement(iconsList[config.props.prefix]) : null}\n        suffix={config.props.suffix ? React.createElement(iconsList[config.props.suffix]) : null}\n      />\n    )\n  );\n};\nexport default forwardRef(MStatistic);\n"],"names":["MStatistic","config","ref","text","setText","useState","visible","setVisible","useEffect","originText","_b","_a","script","_c","value","error","message","useImperativeHandle","iconsList","icons","jsx","Statistic","omit","React","forwardRef"],"mappings":"8SAYA,MAAMA,EAAa,CAAC,CAAE,OAAAC,GAAyBC,IAAa,OAC1D,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAAS,EAAE,EAC7B,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EAE3CG,EAAAA,UAAU,IAAM,WACd,MAAMC,IAAaC,GAAAC,EAAAV,EAAO,QAAP,YAAAU,EAAc,QAAd,YAAAD,EAAqB,aAAc,GAChDE,GAASC,EAAAZ,EAAO,QAAP,YAAAY,EAAc,OAC7B,IAAIC,EAAyBL,EAE7B,GAAIG,EACE,GAAA,CAEFE,EADiB,IAAI,SAAS,QAAS,WAAWF,CAAM,WAAW,EAClDE,CAAK,QACfC,EAAO,CACN,QAAA,MAAM,SAAUA,CAAK,EAC7BC,EAAQ,MAAM,KAAK,UAAUD,CAAK,CAAC,CAAA,CAG/BX,EAAAU,GAAA,YAAAA,EAAO,UAAU,CAAA,EACxB,CAACb,EAAO,MAAM,OAAOU,EAAAV,EAAO,QAAP,YAAAU,EAAc,MAAM,CAAC,EAG7CM,EAAA,oBAAoBf,EAAK,KAChB,CACL,MAAO,CACLK,EAAW,EAAI,CACjB,EACA,MAAO,CACLA,EAAW,EAAK,CAAA,CAEpB,EACD,EAED,MAAMW,EAAoCC,EAC1C,OACEb,GACEc,EAAA,IAACC,EAAA,CACC,MAAOpB,EAAO,MACb,GAAGqB,EAAKrB,EAAO,MAAO,CAAC,SAAU,SAAU,QAAQ,CAAC,EACrD,MAAOE,EACP,OAAQF,EAAO,MAAM,OAASsB,EAAM,cAAcL,EAAUjB,EAAO,MAAM,MAAM,CAAC,EAAI,KACpF,OAAQA,EAAO,MAAM,OAASsB,EAAM,cAAcL,EAAUjB,EAAO,MAAM,MAAM,CAAC,EAAI,IAAA,CACtF,CAGN,EACeuB,EAAAA,EAAAA,WAAWxB,CAAU"}