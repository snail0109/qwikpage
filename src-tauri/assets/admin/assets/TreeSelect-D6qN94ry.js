import{r as t,j as i}from"./index-Ba8_Z7I5.js";import{u as D,h as y,F as E,X as I}from"./Page-zRx-fbuc.js";import{useFormContext as T}from"./context-CZSQjkXQ.js";import{u as W}from"./index-d9iZx7WN.js";import"./index-DzTVI9Lo.js";import"./index-C2BeiomC.js";const j=({type:n,config:e,onChange:o},f)=>{var u;const{initValues:b}=T(),[c,p]=t.useState([]),[h,l]=t.useState(!0),[v,s]=t.useState(),S=D(W(a=>a.page.pageData.variableData));t.useEffect(()=>{var d;const a=(d=e.props.formItem)==null?void 0:d.name,r=e.props.defaultValue;b(n,a,r)},[e.props.defaultValue]),t.useEffect(()=>{typeof e.props.formWrap.disabled=="boolean"&&s(e.props.formWrap.disabled)},[e.props.formWrap.disabled]),t.useEffect(()=>{m({})},[e.api,((u=e.api)==null?void 0:u.sourceType)=="variable"?S:""]);const m=a=>{y(e.api,a).then(r=>{(r==null?void 0:r.code)===0&&(Array.isArray(r.data)?p(r.data):(console.error("[TreeSelect]","data数据格式错误，请检查"),p([])))})};t.useImperativeHandle(f,()=>({show(){l(!0)},hide(){l(!1)},enable(){s(!1)},disable(){s(!0)},update:a=>{m(a)}}));const x=a=>{o&&o({[e.props.formItem.name]:a})};return h&&i.jsx(E.Item,{...e.props.formItem,children:i.jsx(I,{...e.props.formWrap,disabled:v,variant:e.props.formWrap.variant||void 0,treeData:c,style:e.style,onChange:a=>x(a)})})},H=t.memo(t.forwardRef(j));export{H as default};
