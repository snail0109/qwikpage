import{r as t,j as u}from"./index-Ba8_Z7I5.js";import{u as C,h as D,F as E,q as I}from"./Page-zRx-fbuc.js";import{useFormContext as W}from"./context-CZSQjkXQ.js";import"./index-d9iZx7WN.js";import"./index-DzTVI9Lo.js";import"./index-C2BeiomC.js";const j=({type:n,config:a,onChange:o},f)=>{var m;const{initValues:b}=W(),[c,p]=t.useState([]),[v,d]=t.useState(!0),[h,r]=t.useState(),x=C(e=>e.page.pageData.variableData);t.useEffect(()=>{var i;const e=(i=a.props.formItem)==null?void 0:i.name,s=a.props.defaultValue;b(n,e,s)},[a.props.defaultValue]),t.useEffect(()=>{typeof a.props.formWrap.disabled=="boolean"&&r(a.props.formWrap.disabled)},[a.props.formWrap.disabled]),t.useEffect(()=>{l({})},[a.api,((m=a.api)==null?void 0:m.sourceType)=="variable"?x:""]);const l=e=>{D(a.api,e).then(s=>{(s==null?void 0:s.code)===0&&(Array.isArray(s.data)?p(s.data):(console.error("[Cascader]","data数据格式错误，请检查"),p([])))})};t.useImperativeHandle(f,()=>({show(){d(!0)},hide(){d(!1)},enable(){r(!1)},disable(){r(!0)},update:e=>{l(e)}}));const y=e=>{o&&o({[a.props.formItem.name]:e})};return v&&u.jsx(E.Item,{...a.props.formItem,children:u.jsx(I,{...a.props.formWrap,disabled:h,variant:a.props.formWrap.variant||void 0,options:c,style:{...a.style},onChange:e=>y(e)})})},q=t.forwardRef(j);export{q as default};
